(this.webpackJsonpcollections=this.webpackJsonpcollections||[]).push([[0],{23:function(n,e,t){"use strict";t.r(e);var a=t(6),r=t.n(a),c=t(5),i=t(7),s=t(12),u=t(4),o=t(9);function d(){return(d=Object(i.a)(r.a.mark((function n(e,t){var a,c;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({query:"\n        query SingleProduct {\n          site {\n            products(entityIds: [".concat(t,"], first: 50) {\n              edges {\n                node {\n                  name\n                  entityId\n                  path\n                  addToCartUrl\n                  defaultImage {\n                      url (width: 200)\n                  }\n                  inventory {\n                    aggregated {\n                      availableToSell\n                    }\n                  }\n                  description\n                  warranty\n                  customFields {\n                    edges {\n                      node {\n                        name\n                        value\n                      }\n                    }\n                  }\n                  options (first: 50){\n                    edges{\n                        node{\n                            displayName\n                            entityId\n                            values (first: 50){\n                                edges{\n                                    node{\n                                        label\n                                        entityId\n                                    }\n                                }\n                            }\n                        }\n                    }\n                  }\n                  variants {\n                    edges {\n                      node {\n                        sku\n                        prices {\n                          price {\n                            value\n                          }\n                        }\n                        productOptions {\n                          edges {\n                            node {\n                              displayName\n                              __typename\n                              ... OptionFields\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                  prices {\n                    price {\n                      value\n                      currencyCode\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        fragment OptionFields on MultipleChoiceOption {\n          values {\n            edges {\n              node {\n                label\n                ... SwatchOptions\n              }\n            }\n          }\n        }\n      \n        fragment SwatchOptions on SwatchOptionValue {\n          hexColors\n          imageUrl (width: 200)\n        }\n      ")})});case 2:return a=n.sent,n.next=5,a.json();case 5:return c=n.sent,n.abrupt("return",p(c));case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function p(n){var e=n.data.site.products.edges,t=0;return e.map((function(n){var e=n.node;t++;var a=n.node.options.edges.map((function(n){var e=n.node.values.edges.map((function(n){return{label:n.node.label,id:n.node.entityId,in_stock:!0}}));return{label:n.node.displayName,id:n.node.entityId,selected:"",values:e}}));return{key:t,name:e.name,id:e.entityId,url:e.path,addcart:e.addToCartUrl,image:e.defaultImage.url,price:e.prices.price.value,options:a,qty:1,adding:!1}}))}var l=function(n){var e=n.data,t=n.updateBlock,a=n.updateQty,r=n.addCart;return console.log("product grid: ",e),Object(u.jsx)("ul",{className:"collection-grid",children:e?e.map((function(n){return Object(u.jsxs)("li",{children:[Object(u.jsx)("div",{className:"collection-img",children:Object(u.jsx)("a",{href:n.url,children:Object(u.jsx)("img",{src:n.image})})}),Object(u.jsxs)("div",{className:"collection-details",children:[Object(u.jsx)("p",{children:Object(u.jsx)("a",{href:n.url,children:Object(u.jsx)("strong",{children:n.name})})}),Object(u.jsx)("p",{children:(Math.round(100*n.price)/100).toFixed(2)}),n.options.map((function(e,a){return Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{children:e.label}),Object(u.jsxs)("select",{value:e.selected,onChange:function(a){return t(n.key,n.id,e.label,a.target.value)},children:[Object(u.jsxs)("option",{value:"",children:["-- Choose ",e.label," --"]},a),e.values.map((function(n,e){return Object(u.jsxs)("option",{value:n.id,disabled:!n.in_stock,children:[n.label," ",n.in_stock?"":"(Out of stock)"]},e)}))]})]},a)})),Object(u.jsx)("input",{type:"number",value:n.qty,onChange:function(e){return a(n.id,e.target.value)}}),Object(u.jsx)("button",{className:"button",onClick:function(e){return r(n.key,n.sku,n.qty)},disabled:n.adding,children:n.adding?"Adding To Cart":"Add To Cart"}),n.addedToCart?Object(u.jsxs)("span",{className:"checkmark",children:[Object(u.jsx)("div",{className:"checkmark_circle"}),Object(u.jsx)("div",{className:"checkmark_stem"}),Object(u.jsx)("div",{className:"checkmark_kick"})]}):""]})]},n.key)})):null})},b=t(16);function f(n,e){return j.apply(this,arguments)}function j(){return(j=Object(i.a)(r.a.mark((function n(e,t){var a,c,i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=window.BCData.csrf_token,c="authenticity_token=".concat(a,"&action=add&product_id=").concat(e),i=t.reduce((function(n,e){return n+"&attribute[".concat(e.id,"]=").concat(e.selected)}),""),c+=i+"&qty[]=1",n.abrupt("return",new Promise((function(n){b.a.api.productAttributes.optionChange(e,c,[],(function(e,t){console.log(t);var a={sku:t.data.sku,stock:t.data.stock,in_stock_attributes:t.data.in_stock_attributes,price:t.data.price.without_tax.value};n(a)}))})));case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function h(n,e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(r.a.mark((function n(e,t){var a,c;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=[],c=0;case 2:if(!(c<e.length)){n.next=11;break}return n.t0=a,n.next=6,t(e[c]);case 6:n.t1=n.sent,n.t0.push.call(n.t0,n.t1);case 8:c++,n.next=2;break;case 11:return n.abrupt("return",a);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var k=function(n){var e=n.token,t=n.productIds,a=Object(o.useState)(null),p=Object(s.a)(a,2),b=p[0],j=p[1];function O(n,e,t){return k.apply(this,arguments)}function k(){return(k=Object(i.a)(r.a.mark((function n(e,t,a){var i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=b.map((function(n){if(n.key===e){var r=n.options.map((function(n){return n.label===t?Object(c.a)(Object(c.a)({},n),{},{selected:a}):n}));return Object(c.a)(Object(c.a)({},n),{},{options:r})}return n})),j(i),n.abrupt("return",i);case 3:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function v(n,e,t){return m.apply(this,arguments)}function m(){return(m=Object(i.a)(r.a.mark((function n(e,t,a){var s;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h(a,function(){var n=Object(i.a)(r.a.mark((function n(a){var i,s;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a.key!==e){n.next=6;break}return n.next=3,f(t,a.options);case 3:n.t0=n.sent,n.next=7;break;case 6:n.t0=null;case 7:if(!(i=n.t0)){n.next=13;break}return s=a.options.map((function(n){var e=n.values.map((function(n){var e=!0;return void 0!==i.in_stock_attributes&&i.in_stock_attributes.indexOf(n.id)<0&&(e=!1),Object(c.a)(Object(c.a)({},n),{},{in_stock:e})}));return Object(c.a)(Object(c.a)({},n),{},{values:e})})),n.abrupt("return",Object(c.a)(Object(c.a)({},a),{},{options:s,sku:i.sku,stock:i.stock,price:i.price}));case 13:return n.abrupt("return",Object(c.a)({},a));case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 2:s=n.sent,j(s);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function y(){return(y=Object(i.a)(r.a.mark((function n(e,t,a,c){var i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O(e,a,c);case 2:i=n.sent,v(e,t,i);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function x(){return(x=Object(i.a)(r.a.mark((function n(e,t,a){var s,u,o;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=10;break}return n.next=3,h(b,function(){var n=Object(i.a)(r.a.mark((function n(t){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.key!==e){n.next=4;break}return n.abrupt("return",Object(c.a)(Object(c.a)({},t),{},{adding:!0}));case 4:return n.abrupt("return",Object(c.a)({},t));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 3:return s=n.sent,j(s),n.next=7,fetch("/cart.php?action=add&sku=".concat(t,"&qty=").concat(a));case 7:u=n.sent,o=u.url.includes("cart.php"),j((function(n){return n.map((function(n){return n.sku===t?Object(c.a)(Object(c.a)({},n),{},{addedToCart:o,adding:!1}):Object(c.a)({},n)}))}));case 10:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(o.useEffect)((function(){(function(n,e){return d.apply(this,arguments)})(e,t).then((function(n){j(n)}))}),[]),Object(u.jsx)("div",{className:"App",children:Object(u.jsx)(l,{data:b,updateBlock:function(n,e,t,a){return y.apply(this,arguments)},updateQty:function(n,e){var t=b.map((function(t,a){return t.id===n?Object(c.a)(Object(c.a)({},t),{},{qty:e}):t}));j(t)},addCart:function(n,e,t){return x.apply(this,arguments)}})})};e.default=k}},[[23,1,2]]]);
//# sourceMappingURL=main.d8e091dd.chunk.js.map